# CausalEngine v2.0.4 Release Notes

## 发布日期
2024-12-27

## 新特性

### 🎯 离散有序激活（Ordinal Activation）

实现了数学文档中定义的第三种激活函数，用于处理离散有序值预测任务：

```python
# 对于离散有序值 y ∈ {0, 1, ..., K-1}
# P(Y = k) = P(C_k < S ≤ C_{k+1})
# 其中 C_0 = -∞, C_K = +∞
```

**使用示例：**
```python
# 创建一个5级评分系统
engine = CausalEngine(
    hidden_size=64,
    vocab_size=1,
    activation_modes="ordinal",
    ordinal_num_classes=5,  # 5个级别：1-5星
    ordinal_threshold_init=1.0
)
```

**支持的配置：**
- 每个输出维度可以独立配置为离散有序模式
- 每个离散有序维度可以有不同的类别数
- 自动初始化合理的阈值分布

## 架构改进

### 📐 确认模块化设计决策

经过深入分析，确认 ActivationHead 应该保持作为独立模块，理由包括：

1. **数学清晰性**：S（决策分布）是数学上有意义的中间表示
2. **工程灵活性**：支持多任务学习和迁移学习
3. **扩展性**：添加新激活模式不影响核心因果逻辑

详见：`causal_engine/ARCHITECTURE_DECISION.md`

## 测试

新增测试脚本 `scripts/test_ordinal_activation.py`，演示了：
- 混合激活模式（分类 + 回归 + 离散有序）
- 纯离散有序激活
- 多任务配置示例

## 兼容性

- 完全向后兼容
- 现有代码无需修改即可继续使用
- 新功能通过可选参数启用 