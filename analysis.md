# CausalQwen 项目分析报告

## 核心数学理论（基于 design-docs/math/mathematical_foundations.md）

### 1. 柯西分布：认知不确定性的数学表达

**核心概念**：
- 柯西分布是重尾分布，具有极重的尾部特性
- 一维柯西分布PDF：$f(x; \mu, \gamma) = \frac{1}{\pi\gamma} \cdot \frac{1}{1 + \left(\frac{x-\mu}{\gamma}\right)^2}$
- $\mu$是位置参数，$\gamma>0$是尺度参数
- 柯西分布的均值、方差不存在，体现"极端事件总是可能发生"的哲学

**重要特性**：
- 稳定性与自相似性：柯西随机变量的线性组合仍为柯西分布
- 与正态分布对比：极重尾vs轻尾，不存在均值vs存在均值
- 适合表示"开放世界"不确定性

### 2. 推断-行动范式

**核心架构**：
- 模型首先"推断"潜在因果状态U的概率分布
- 然后基于此分布进行"行动"（预测）
- $U \sim \text{Cauchy}(\text{loc}(z), \text{scale}(z))$，其中z是特征向量

**关键组件**：
1. **推断网络**：从特征z推断因果状态U的分布参数
2. **行动网络**：
   - 分类头：使用OvR策略，每个词元独立预测决策分数
   - 回归头：预测数值，使用柯西分布的中位数作为点估计

### 3. 无采样训练的数学基础

**柯西分布的线性组合性质**：
- 如果 $X_i \sim \text{Cauchy}(\mu_i, \gamma_i)$，则 $Y = \sum(a_i X_i) + b \sim \text{Cauchy}(\sum(a_i \mu_i) + b, \sum(|a_i| \gamma_i))$
- 这使得可以直接从分布参数计算决策分数分布，无需采样

## 实验设计（基于 design-docs/experiments/experiment_design.md）

### 核心实验框架

**数据类型**：
1. **基础数值文本**：简单陈述句中的数字
2. **问答格式**：以问答形式呈现的数字
3. **极端数值**：测试重尾分布优势的关键场景
4. **边界值**：测试边界情况处理

**评估指标**：
- 分类准确率：成功预测<NUM>词元的比例
- <NUM>词元平均排名：在词汇表中的概率排名
- 回归误差：数值预测的RMSE/MAE

### 实验结果（基于 docs/experiments/qwen_finetuning_report.md）

**微调前后对比**：
- 准确率：0% → 100%
- 平均排名：8-9万名 → 第1名
- 证明了因果框架的有效性

## 项目结构分析

**核心模块**：
- src/models/：模型实现（特征网络、推断网络、行动网络）
- src/utils/：工具函数（分布、损失函数、评估指标）
- src/data/：数据处理（合成数据生成、分词器）
- design-docs/：设计文档
- docs/：用户文档

**精简版本需要保留的核心**：
1. 核心数学理论文档
2. 关键代码实现
3. 基本实验验证
4. 简洁的使用说明

