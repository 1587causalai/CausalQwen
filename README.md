# Causal-Sklearn - å› æœæœºå™¨å­¦ä¹ é©å‘½

åŸºäºçªç ´æ€§CausalEngineâ„¢ç®—æ³•çš„scikit-learnå…¼å®¹å®ç° - å°†å› æœæ¨ç†å¸¦å…¥ä¼ ç»Ÿæœºå™¨å­¦ä¹ ç”Ÿæ€ç³»ç»Ÿã€‚

## é¡¹ç›®æ¦‚è¿°

Causal-Sklearnå°†å¼ºå¤§çš„å› æœæ¨ç†èƒ½åŠ›å¼•å…¥åˆ°ç†Ÿæ‚‰çš„scikit-learnç”Ÿæ€ç³»ç»Ÿä¸­ã€‚åŸºäºé©å‘½æ€§çš„CausalEngineâ„¢ç®—æ³•æ„å»ºï¼Œå®ƒæä¾›äº†ä¼ ç»ŸMLä¼°è®¡å™¨çš„ç›´æ¥æ›¿ä»£å“ï¼Œèƒ½å¤Ÿç†è§£å› æœå…³ç³»è€Œä¸ä»…ä»…æ˜¯ç›¸å…³æ€§ã€‚

### ğŸ¯ æ ¸å¿ƒçªç ´
- **å› æœvsç›¸å…³**: è¶…è¶Šä¼ ç»Ÿæ¨¡å¼åŒ¹é…ï¼Œå®ç°çœŸæ­£çš„å› æœå…³ç³»ç†è§£
- **é²æ£’æ€§ä¼˜åŠ¿**: åœ¨å™ªå£°å’Œå¼‚å¸¸å€¼å­˜åœ¨æ—¶è¡¨ç°å‡ºè‰²ï¼Œè¿œè¶…ä¼ ç»Ÿæ–¹æ³•
- **æ•°å­¦åˆ›æ–°**: ä»¥æŸ¯è¥¿åˆ†å¸ƒä¸ºæ ¸å¿ƒçš„å…¨æ–°æ•°å­¦æ¡†æ¶
- **sklearnå…¼å®¹**: å®Œç¾èå…¥ç°æœ‰MLå·¥ä½œæµï¼Œæ— éœ€æ”¹å˜ä½¿ç”¨ä¹ æƒ¯

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

- **ğŸ”§ Scikit-learnå…¼å®¹**: å®Œå…¨å…¼å®¹sklearnæ¥å£ï¼Œå¯ç›´æ¥æ›¿æ¢`MLPRegressor`å’Œ`MLPClassifier`
- **ğŸ§  å› æœæ¨ç†**: è¶…è¶Šæ¨¡å¼åŒ¹é…ï¼Œç†è§£æ•°æ®èƒŒåçš„å› æœå…³ç³»
- **ğŸ›¡ï¸ é²æ£’æ€§å“è¶Š**: åœ¨æ ‡ç­¾å™ªå£°å’Œå¼‚å¸¸å€¼ç¯å¢ƒä¸‹æ€§èƒ½è¿œè¶…ä¼ ç»Ÿæ–¹æ³•
- **ğŸ“Š åˆ†å¸ƒé¢„æµ‹**: æä¾›å®Œæ•´çš„åˆ†å¸ƒè¾“å‡ºï¼Œè€Œéä»…ç‚¹ä¼°è®¡
- **âš™ï¸ å¤šæ¨¡å¼æ¨ç†**: æ”¯æŒdeterministicã€standardã€samplingç­‰å¤šç§æ¨ç†æ¨¡å¼
- **ğŸ¯ çœŸå®ä¸–ç•ŒéªŒè¯**: åœ¨åŠ å·æˆ¿ä»·ç­‰çœŸå®æ•°æ®é›†ä¸Šå±•ç°æ˜¾è‘—ä¼˜åŠ¿

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºç¡€ä½¿ç”¨ç¤ºä¾‹

```python
from causal_sklearn import MLPCausalRegressor, MLPCausalClassifier
from sklearn.datasets import make_regression, make_classification
from sklearn.model_selection import train_test_split

# å›å½’ç¤ºä¾‹
X, y = make_regression(n_samples=1000, n_features=20, noise=0.1)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)

regressor = MLPCausalRegressor(mode='standard', random_state=42)
regressor.fit(X_train, y_train)
predictions = regressor.predict(X_test)

# åˆ†ç±»ç¤ºä¾‹
X, y = make_classification(n_samples=1000, n_features=20, n_classes=3)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)

classifier = MLPCausalClassifier(mode='standard', random_state=42)
classifier.fit(X_train, y_train)
predictions = classifier.predict(X_test)
probabilities = classifier.predict_proba(X_test)
```

### ğŸš€ å¿«é€ŸéªŒè¯æµ‹è¯•

è¿è¡Œå¿«é€Ÿæµ‹è¯•è„šæœ¬ï¼ŒåŒæ—¶éªŒè¯å›å½’å’Œåˆ†ç±»æ€§èƒ½ï¼š

```bash
# è¿è¡Œå®Œæ•´çš„å¿«é€Ÿæµ‹è¯•ï¼ˆå›å½’+åˆ†ç±»ï¼‰
python scripts/quick_test_causal_engine.py

# è¿™ä¸ªè„šæœ¬å°†ï¼š
# 1. ç”Ÿæˆåˆæˆæ•°æ®ï¼ˆå›å½’ï¼š4000æ ·æœ¬Ã—12ç‰¹å¾ï¼Œåˆ†ç±»ï¼š4000æ ·æœ¬Ã—10ç‰¹å¾Ã—3ç±»ï¼‰
# 2. åœ¨30%å™ªå£°ä¸‹æ¯”è¾ƒ8ç§æ–¹æ³•æ€§èƒ½
# 3. ç»Ÿä¸€æ ‡å‡†åŒ–ç­–ç•¥ç¡®ä¿å…¬å¹³æ¯”è¾ƒ
# 4. ç”Ÿæˆå®Œæ•´çš„æ€§èƒ½åˆ†ææŠ¥å‘Šå’Œå¯è§†åŒ–å›¾è¡¨
```

**å¿«é€Ÿæµ‹è¯•äº®ç‚¹**ï¼š
- âš¡ å¿«é€ŸéªŒè¯ï¼šå‡ åˆ†é’Ÿå†…å®Œæˆå…¨é¢æµ‹è¯•
- ğŸ”„ åŒä»»åŠ¡æ”¯æŒï¼šåŒæ—¶æµ‹è¯•å›å½’å’Œåˆ†ç±»èƒ½åŠ›
- ğŸ¯ 8ç§æ–¹æ³•å¯¹æ¯”ï¼šsklearn/PyTorchåŸºçº¿ + CausalEngineå››ç§æ¨¡å¼
- ğŸ“Š ç§‘å­¦å®éªŒè®¾è®¡ï¼šæ— æ•°æ®æ³„éœ²çš„æ ‡å‡†åŒ–ç­–ç•¥
- ğŸ›¡ï¸ å™ªå£°é²æ£’æ€§ï¼šåœ¨30%å™ªå£°ç¯å¢ƒä¸‹éªŒè¯ä¼˜åŠ¿

### ğŸ  çœŸå®ä¸–ç•Œæ•™ç¨‹ - åŠ å·æˆ¿ä»·é¢„æµ‹

è¿è¡Œå®Œæ•´çš„çœŸå®ä¸–ç•Œå›å½’æ•™ç¨‹ï¼Œå±•ç¤ºCausalEngineçš„å¼ºå¤§æ€§èƒ½ï¼š

```bash
# è¿è¡ŒçœŸå®ä¸–ç•Œå›å½’æ•™ç¨‹ï¼ˆsklearn-styleç‰ˆæœ¬ï¼‰
python examples/comprehensive_causal_modes_tutorial_sklearn_style.py

# è¿™ä¸ªæ•™ç¨‹å°†ï¼š
# 1. åŠ è½½åŠ å·æˆ¿ä»·æ•°æ®é›†ï¼ˆ20,640ä¸ªæ ·æœ¬ï¼‰
# 2. åœ¨30%æ ‡ç­¾å™ªå£°ä¸‹æ¯”è¾ƒ13ç§æ–¹æ³•
# 3. æµ‹è¯•CausalEngineæ‰€æœ‰4ç§æ¨ç†æ¨¡å¼
# 4. ç”Ÿæˆæ ‡å‡†ç‰ˆå’Œæ‰©å±•ç‰ˆæ€§èƒ½å¯¹æ¯”å›¾è¡¨
```

**çœŸå®ä¸–ç•Œæ•™ç¨‹äº®ç‚¹**ï¼š
- ğŸŒ çœŸå®æ•°æ®ï¼šåŠ å·æˆ¿ä»·æ•°æ®é›†çš„å®Œæ•´åˆ†æ
- ğŸ”¬ å…¨é¢å¯¹æ¯”ï¼š13ç§æ–¹æ³•ï¼ˆä¼ ç»ŸML + ç¨³å¥å›å½’ + CausalEngineå››æ¨¡å¼ï¼‰
- ğŸ“Š åŒé‡å¯è§†åŒ–ï¼šæ ‡å‡†ç‰ˆï¼ˆ9ç§æ ¸å¿ƒæ–¹æ³•ï¼‰+ æ‰©å±•ç‰ˆï¼ˆ13ç§å…¨æ–¹æ³•ï¼‰
- ğŸ¯ CausalEngineä¸“é¡¹ï¼šå››ç§æ¨ç†æ¨¡å¼çš„æ·±åº¦å¯¹æ¯”åˆ†æ
- ğŸ›¡ï¸ é²æ£’æ€§éªŒè¯ï¼šåœ¨30%å™ªå£°ç¯å¢ƒä¸‹çš„çœŸå®è¡¨ç°

### ğŸ“ˆ é²æ£’æ€§æµ‹è¯•è„šæœ¬

æµ‹è¯•ç®—æ³•åœ¨ä¸åŒå™ªå£°æ°´å¹³ä¸‹çš„é²æ£’æ€§è¡¨ç°ï¼š

```bash
# å›å½’ç®—æ³•é²æ£’æ€§æµ‹è¯•ï¼ˆçœŸå®æ•°æ®é›†ï¼‰
python scripts/regression_robustness_real_datasets.py

# åˆ†ç±»ç®—æ³•é²æ£’æ€§æµ‹è¯•ï¼ˆçœŸå®æ•°æ®é›†ï¼‰
python scripts/classification_robustness_real_datasets.py

# è¿™äº›è„šæœ¬å°†ï¼š
# 1. ä½¿ç”¨sklearnå†…ç½®çœŸå®æ•°æ®é›†
# 2. æµ‹è¯•0%-100%å™ªå£°æ¢¯åº¦ï¼ˆ11ä¸ªçº§åˆ«ï¼‰
# 3. æ¯”è¾ƒå¤šç§ç®—æ³•çš„é²æ£’æ€§æ›²çº¿
# 4. æ”¯æŒå¤šæ¬¡è¿è¡Œå–å¹³å‡ï¼Œæé«˜ç»“æœç¨³å®šæ€§
```

#

## ğŸ”¬ åŸºå‡†æµ‹è¯•ä¸æ€§èƒ½éªŒè¯

### ä½¿ç”¨æˆ‘ä»¬çš„åŸºå‡†æµ‹è¯•æ¡†æ¶

```python
from causal_sklearn.benchmarks import BaselineBenchmark
from sklearn.datasets import fetch_california_housing

# åˆ›å»ºåŸºå‡†æµ‹è¯•å®ä¾‹
benchmark = BaselineBenchmark()

# åŠ è½½çœŸå®æ•°æ®
data = fetch_california_housing()
X, y = data.data, data.target

# è¿è¡Œå®Œæ•´çš„åŸºå‡†æµ‹è¯•æ¯”è¾ƒ
results = benchmark.compare_models(
    X=X, y=y,
    task_type='regression',
    anomaly_ratio=0.25,  # 25%æ ‡ç­¾å™ªå£°
    causal_modes=['deterministic', 'standard'],
    verbose=True
)

# å¿«é€Ÿæµ‹è¯•ç‰ˆæœ¬ (ä½¿ç”¨è¾ƒå°æ•°æ®é›†)
# results = benchmark.compare_models(X=X[:1000], y=y[:1000], ...)

# æ‰“å°è¯¦ç»†ç»“æœ
benchmark.print_results(results, 'regression')
```

### ğŸ¯ æ€§èƒ½äº®ç‚¹

åœ¨åŠ å·æˆ¿ä»·æ•°æ®é›†ï¼ˆ25%æ ‡ç­¾å™ªå£°ï¼‰ä¸Šçš„çœŸå®è¿è¡Œç»“æœï¼š

| æ–¹æ³• | éªŒè¯é›† MAE | éªŒè¯é›† MdAE | éªŒè¯é›† RMSE | éªŒè¯é›† RÂ² | æµ‹è¯•é›† MAE | æµ‹è¯•é›† MdAE | æµ‹è¯•é›† RMSE | æµ‹è¯•é›† RÂ² |
|------|-----------|-------------|-------------|-----------|-----------|-------------|-------------|-----------|
| sklearn MLP | 0.5230 | 0.3992 | 0.7196 | 0.5025 | 0.5056 | 0.3803 | 0.7085 | 0.4922 |
| PyTorch MLP | 0.4868 | 0.3696 | 0.6626 | 0.5782 | 0.4912 | 0.3716 | 0.6705 | 0.5451 |
| CausalEngine (Det) | 0.5581 | 0.4434 | 0.7485 | 0.4617 | 0.5429 | 0.4278 | 0.7349 | 0.4536 |
| **CausalEngine (Std)** | **0.3446** | **0.2174** | **0.5482** | **0.7112** | **0.3326** | **0.2055** | **0.5112** | **0.7356** |

**çœŸå®æ•°æ®éªŒè¯çš„å…³é”®ä¼˜åŠ¿**ï¼š
- ğŸ† **æ€§èƒ½é¢†å…ˆ**: CausalEngine (Standard) åœ¨æµ‹è¯•é›†ä¸ŠRÂ²è¾¾åˆ°0.7356ï¼Œæ˜¾è‘—è¶…è¿‡ä¼ ç»Ÿæ–¹æ³•
- ğŸ¯ **è¯¯å·®æ§åˆ¶**: æµ‹è¯•é›†MAEä»…0.3326ï¼Œæ¯”sklearn MLPé™ä½34.2%
- ğŸ›¡ï¸ **å™ªå£°é²æ£’**: åœ¨25%æ ‡ç­¾å™ªå£°ç¯å¢ƒä¸‹ä»ä¿æŒæœ€ä¼˜æ€§èƒ½
- ğŸ“Š **ä¸€è‡´æ€§å¼º**: éªŒè¯é›†å’Œæµ‹è¯•é›†è¡¨ç°é«˜åº¦ä¸€è‡´ï¼Œè¯æ˜æ¨¡å‹æ³›åŒ–èƒ½åŠ›
- ğŸ§  **å› æœç†è§£**: é€šè¿‡å› æœæ¨ç†å®ç°æ›´æ·±å±‚çš„æ•°æ®ç†è§£

## ğŸ“š æ–‡æ¡£ä¸ç†è®ºåŸºç¡€

### ğŸ§® æ•°å­¦ç†è®ºåŸºç¡€
- **[ğŸŒŸ æ•°å­¦åŸºç¡€ (ä¸­æ–‡)](docs/MATHEMATICAL_FOUNDATIONS_CN.md)** - **æœ€æ ¸å¿ƒæ–‡æ¡£** å®Œæ•´çš„CausalEngineç†è®ºæ¡†æ¶
- **[One-Pager Summary](docs/ONE_PAGER.md)** - Executive summary of CausalEngine

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨Apache License 2.0 - è¯¦è§[LICENSE](LICENSE)æ–‡ä»¶ã€‚


## ğŸ“– å­¦æœ¯å¼•ç”¨

å¦‚æœæ‚¨åœ¨ç ”ç©¶ä¸­ä½¿ç”¨äº†Causal-Sklearnï¼Œè¯·å¼•ç”¨ï¼š

```bibtex
@software{causal_sklearn,
  title={Causal-Sklearn: Scikit-learn Compatible Causal Regression and Classification},
  author={Heyang Gong},
  year={2025},
  url={https://github.com/1587causalai/CausalQwen/tree/causal-sklearn-mvp},
  note={åŸºäºCausalEngineâ„¢æ ¸å¿ƒçš„å› æœå›å½’å’Œå› æœåˆ†ç±»ç®—æ³•çš„scikit-learnå…¼å®¹å®ç°}
}
```

---

<div align="center">

**ğŸŒŸ CausalEngineâ„¢ - é‡æ–°å®šä¹‰æœºå™¨å­¦ä¹ çš„å› æœæ¨ç†é©å‘½ ğŸŒŸ**

*ä»ç›¸å…³æ€§åˆ°å› æœæ€§ï¼Œä»æ¨¡å¼åŒ¹é…åˆ°å› æœç†è§£*

</div>